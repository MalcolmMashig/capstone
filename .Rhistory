library(tidyverse)
data_2018_2019 <- filter(data_player_year, Team_2018 != "NA" & Team_2019 != "NA")
source('~/Desktop/STAT 4996/capstone/data/New data wrangle.R')
setwd("~/Desktop/STAT 4996/capstone/data")
source('~/Desktop/STAT 4996/capstone/data/New data wrangle.R')
data_2018_2019 <- filter(data_player_year, Team_2018 != "NA" & Team_2019 != "NA")
names(data_2018_2019)
model1 <- lm(xFIP_2019 ~ Age_2018 + xFIP_2018 + FBv_2018, data=data_2018_2019)
summary(model1)
model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018, data=data_2018_2019)
summary(model2)
model3 <- lm(xFIP_2019 ~ ERA_2018 + WHIP_2018 + WAR_2018 + xFIP_2018 + BABIP_2018 + FRM_2018, data=data_2018_2019)
summary(model3)
model4 <- lm(xFIP_2019 ~ `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018` + `HR/9_2018`, data=data_2018_2019)
summary(model4)
model5 <- lm(xFIP_2019 ~ `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018, data=data_2018_2019)
summary(model5)
model6 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2019`+ `K%_2018`
+ WAR_2018 + `Flyball%_2018` + BABIP_2018 + `FB%_2018`, data=data_2018_2019)
summary(model6)
model7 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `HR/9_2019`+ `K%_2018`
+ WAR_2018 + `Flyball%_2018` + BABIP_2018 + `FB%_2018`, data=data_2018_2019)
summary(model7)
model8 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `HR/9_2019`+ WAR_2018
+ `Flyball%_2018` + BABIP_2018 + `FB%_2018`, data=data_2018_2019)
summary(model8)
model9 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `HR/9_2019` + `Flyball%_2018`
+ BABIP_2018, data=data_2018_2019)
summary(model9)
model10 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `HR/9_2019` + `Flyball%_2018`,
data=data_2018_2019)
summary(model10)
model11 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `HR/9_2019`, data=data_2018_2019)
summary(model11)  # all variables very significant
model6 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ WAR_2018 + `Flyball%_2018` + BABIP_2018 + `FB%_2018`, data=data_2018_2019)
summary(model6)
model7 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `HR/9_2018`+ `K%_2018`
+ WAR_2018 + `Flyball%_2018` + BABIP_2018 + `FB%_2018`, data=data_2018_2019)
summary(model7)
model8 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `HR/9_2018`+ WAR_2018
+ `Flyball%_2018` + BABIP_2018 + `FB%_2018`, data=data_2018_2019)
summary(model8)
model9 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `HR/9_2018` + `Flyball%_2018`
+ BABIP_2018, data=data_2018_2019)
summary(model9)
model10 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `HR/9_2018` + `Flyball%_2018`,
data=data_2018_2019)
summary(model10)
model11 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `HR/9_2018`, data=data_2018_2019)
summary(model11)  # all variables very significant
model11 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018, data=data_2018_2019)
summary(model11)  # all variables very significant
data_2018_2019 <- filter(data_player_year, Team_2018 != "NA" & Team_2019 != "NA" & Team_2017 != "NA")
names(data_2018_2019)
Years2model1 <- lm(xFIP_2019 ~ Age_2018 + xFIP_2018 + FBv_2018 + Age_2017 + xFIP_2017 + FBv_2017, data=data2017_2018_2019)
data_2017_2018_2019 <- filter(data_player_year, Team_2018 != "NA" & Team_2019 != "NA" & Team_2017 != "NA")
names(data_2017_2018_2019)
Years2model1 <- lm(xFIP_2019 ~ Age_2018 + xFIP_2018 + FBv_2018 + Age_2017 + xFIP_2017 + FBv_2017, data=data_2017_2018_2019)
summary(Years2model1)
Years2model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018, Age_2017 + GS_2017 + IP_2017 + StartIP_2017 + ERA_2017 + WHIP_2017 + WAR_2017
+ xFIP_2017 + BABIP_2017 + FRM_2017 + `K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017`
+ `HR/9_2017` + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_2017_2018_2019)
Years2model1 <- lm(xFIP_2019 ~ Age_2018 + xFIP_2018 + FBv_2018 + Age_2017 + xFIP_2017 + FBv_2017, data=data_2017_2018_2019)
summary(Years2model1)
Years2model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018, Age_2017 + GS_2017 + IP_2017 + StartIP_2017 + ERA_2017 + WHIP_2017 + WAR_2017
+ xFIP_2017 + BABIP_2017 + FRM_2017 + `K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017`
+ `HR/9_2017` + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_2017_2018_2019)
Years2model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018 Age_2017 + GS_2017 + IP_2017 + StartIP_2017 + ERA_2017 + WHIP_2017 + WAR_2017
+ xFIP_2017 + BABIP_2017 + FRM_2017 + `K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017`
+ `HR/9_2017` + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_2017_2018_2019)
Years2model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018 Age_2017 + GS_2017 + IP_2017 + StartIP_2017 + ERA_2017 + WHIP_2017 + WAR_2017
+ xFIP_2017 + BABIP_2017 + FRM_2017 + `K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017`
+ `HR/9_2017` + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_2017_2018_2019)
Years2model1 <- lm(xFIP_2019 ~ Age_2018 + xFIP_2018 + FBv_2018 + Age_2017 + xFIP_2017
+ FBv_2017, data=data_2017_2018_2019)
summary(Years2model1)
Years2model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018 + Age_2017 + GS_2017 + IP_2017 + StartIP_2017 + ERA_2017 + WHIP_2017 + WAR_2017
+ xFIP_2017 + BABIP_2017 + FRM_2017 + `K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017`
+ `HR/9_2017` + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_2017_2018_2019)
summary(Years2model2)
Years2model3 <- lm(xFIP_2019 ~ ERA_2018 + WHIP_2018 + WAR_2018 + xFIP_2018 + BABIP_2018 + FRM_2018 +
ERA_2017 + WHIP_2017 + WAR_2017 + xFIP_2017 + BABIP_2017 + FRM_2017, data=data_2017_2018_2019)
summary(Years2model3)
Years2model4 <- lm(xFIP_2019 ~ `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018` + `HR/9_2018` +
`K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017` + `HR/9_2017`, data=data_2017_2018_2019)
summary(Years2model4)
Years2model5 <- lm(xFIP_2019 ~ `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018 + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_data_2017_2018_2019)
Years2model5 <- lm(xFIP_2019 ~ `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018 + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_2017_2018_2019)
summary(Years2model5)
Years2model4 <- lm(xFIP_2019 ~ `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018` + `HR/9_2018` +
`K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017` + `HR/9_2017`, data=data_2017_2018_2019)
summary(Years2model4)
Years2model6 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ WAR_2018 + `Flyball%_2018` + BABIP_2018 + `FB%_2018`, data=data_2017_2018_2019)
Years2model3 <- lm(xFIP_2019 ~ ERA_2018 + WHIP_2018 + WAR_2018 + xFIP_2018 + BABIP_2018 + FRM_2018 +
ERA_2017 + WHIP_2017 + WAR_2017 + xFIP_2017 + BABIP_2017 + FRM_2017, data=data_2017_2018_2019)
summary(Years2model3)
Years2model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ FBv_2018 + wFB_2018 + Age_2017 + GS_2017 + IP_2017 + StartIP_2017 + ERA_2017 + WHIP_2017 + WAR_2017
+ xFIP_2017 + BABIP_2017 + FRM_2017 + `K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017`
+ `HR/9_2017` + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ FBv_2017 + wFB_2017, data=data_2017_2018_2019)
summary(Years2model2)
names(data_2017_2018_2019)
Years2model2 <- lm(xFIP_2019 ~ Age_2018 + GS_2018 + IP_2018 + StartIP_2018 + ERA_2018 + WHIP_2018 + WAR_2018
+ xFIP_2018 + BABIP_2018 + FRM_2018 + `K/9_2018` + `BB/9_2018` + `K/BB_2018` + `H/9_2018`
+ `HR/9_2018` + `Groundball%_2018` + `Flyball%_2018` + `K%_2018` + `BB%_2018` + `FB%_2018`
+ `wFB_2018` + `Age_2017` + `GS_2017` + `IP_2017` + `StartIP_2017` + `ERA_2017` + `WHIP_2017` + `WAR_2017`
+ `xFIP_2017` + `BABIP_2017` + `FRM_2017` + `K/9_2017` + `BB/9_2017` + `K/BB_2017` + `H/9_2017`
+ `HR/9_2017` + `Groundball%_2017` + `Flyball%_2017` + `K%_2017` + `BB%_2017` + `FB%_2017`
+ `FBv_2017` + `wFB_2017`, data=data_2017_2018_2019)
summary(Years2model2)
Years2model6 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ WAR_2018 + `Flyball%_2018` + BABIP_2018 + `FB%_2018` + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`HR/9_2017` + `xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model6)
Years2model6 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ WAR_2018 + `Flyball%_2018` + BABIP_2018 + `FB%_2018` + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`HR/9_2017` + `xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model6)
Years2model7 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ BABIP_2018 + `FB%_2018` + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`HR/9_2017` + `xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model7)
Years2model7 <- lm(xFIP_2019 ~ WHIP_2018 + xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ BABIP_2018 + `FB%_2018` + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`HR/9_2017` + `xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model7)
Years2model8 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ BABIP_2018 + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`HR/9_2017` + `xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model8)
Years2model9 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ BABIP_2018 + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`HR/9_2017` + `xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model9)
Years2model8 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `HR/9_2018`+ `K%_2018`
+ BABIP_2018 + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`HR/9_2017` + `xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model8)
Years2model9 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `K%_2018`
+ BABIP_2018 + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model9)
Years2model10 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `K%_2018`
+ BABIP_2018 + `BB/9_2017` + `K/BB_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model10)
Years2model9 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `K%_2018`
+ BABIP_2018 + `BB/9_2017` + `K/BB_2017` + `H/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model9)
Years2model10 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `K%_2018`
+ BABIP_2018 + `BB/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model10)
Years2model10 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `K%_2018`
+ BABIP_2018 + `BB/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
Years2model10 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018 + `K/9_2018` + `K%_2018`
+ BABIP_2018 + `BB/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model10)
Years2model11 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018
+ BABIP_2018 + `BB/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model10)
Years2model11 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018
+ BABIP_2018 + `BB/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model11)
Years2model12 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018
+ BABIP_2018 + `BB/9_2017` +
`xFIP_2017` + `BABIP_2017`, data=data_2017_2018_2019)
Years2model12 <- lm(xFIP_2019 ~ xFIP_2018 + FBv_2018
+ `BB/9_2017`
+ `BABIP_2017`, data=data_2017_2018_2019)
summary(Years2model12)
summary(Years2model12)
summary(Years2model12)  # all variables very significant
library(tidyverse)
# install.packages("here")
library(here)
# install.packages("remotes")
# remotes::install_github("njtierney/brolgar")
library(brolgar)
here::here('data', '01-import-wrangle.R') %>%
source()
fangraphs_clean %>%
group_by(Name) %>%
mutate(avg_fbv = mean(FBv, na.rm = TRUE),
avg_fbpctg = mean(`FB%`, na.rm = TRUE),
avg_ip = mean(IP, na.rm = TRUE),
avg_gs = mean(GS, na.rm = TRUE)
) %>%
ungroup() %>%
filter(experience > 4, Season > 2010) %>%
as_tsibble(key = Name, index = experience) %>%
ggplot() +
geom_line(aes(experience, WAR, group = Name,
color = avg_ip > 160 & avg_gs > 20 & avg_fbv > 90 & avg_fbpctg > 55)) +
facet_sample(n_per_facet = 30, n_facets = 4) +
labs(color = "")
library(tidyverse)
# install.packages("here")
library(here)
# install.packages("remotes")
# remotes::install_github("njtierney/brolgar")
library(brolgar)
install.packages("remotes")
remotes::install_github("njtierney/brolgar")
facet_wrap(~(avg_fbpctg > 60))
facet_wrap(~(avg_fbpctg > 60))
facet_wrap(~(avg_fbpctg > 60))
fangraphs_clean %>%
group_by(Name) %>%
mutate(avg_fbv = mean(FBv, na.rm = TRUE),
avg_fbpctg = mean(`FB%`, na.rm = TRUE),
avg_ip = mean(IP, na.rm = TRUE),
avg_gs = mean(GS, na.rm = TRUE)
) %>%
ungroup() %>%
filter(experience > 4, Season > 2010) %>%
as_tsibble(key = Name, index = experience) %>%
ggplot() +
geom_line(aes(experience, WAR, group = Name,
color = avg_ip > 160 & avg_gs > 20 & avg_fbv > 90 & avg_fbpctg > 55)) +
facet_sample(n_per_facet = 30, n_facets = 4) +
labs(color = "")
fangraphs_clean %>%
group_by(Name) %>%
mutate(avg_fbv = mean(FBv, na.rm = TRUE),
avg_fbpctg = mean(`FB%`, na.rm = TRUE),
avg_ip = mean(IP, na.rm = TRUE),
avg_gs = mean(GS, na.rm = TRUE)
) %>%
ungroup() %>%
filter(experience > 4, Season > 2010) %>%
as_tsibble(key = Name, index = experience) %>%
ggplot() +
geom_line(aes(experience, WAR, group = Name,
color = avg_ip > 160 & avg_gs > 20 & avg_fbv > 90 & avg_fbpctg > 55)) +
facet_sample(n_per_facet = 30, n_facets = 4) +
labs(color = "")
facet_wrap(~(avg_fbpctg > 60))
fangraphs_clean %>%
group_by(Name) %>%
mutate(avg_fbv = mean(FBv, na.rm = TRUE),
avg_fbpctg = mean(`FB%`, na.rm = TRUE),
avg_ip = mean(IP, na.rm = TRUE),
avg_gs = mean(GS, na.rm = TRUE)
) %>%
ungroup() %>%
filter(experience > 4, Season > 2010) %>%
as_tsibble(key = Name, index = experience) %>%
ggplot() +
geom_line(aes(experience, WAR, group = Name,
color = avg_ip > 160 & avg_gs > 20 & avg_fbv > 90 & avg_fbpctg > 55)) +
facet_sample(n_per_facet = 30, n_facets = 4) +
labs(color = "")
facet_wrap(~(avg_fbpctg > 60))
