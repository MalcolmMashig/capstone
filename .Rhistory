data = read.csv("fangraphs.csv")
data = read.csv("fangraphs.csv")
setwd("~/Google Drive/2nd Year/STAT 4996/Github Folder")
setwd("~/Google Drive/2nd Year/STAT 4996/Github Folder/data")
setwd("~/Google Drive/2nd Year/STAT 4996/Github Folder/data")
data = read.csv("fangraphs.csv")
data
fulldata = read.csv("fangraphs.csv")
fulldata = read.csv("fangraphs.csv")
ggplot(fulldata, aes(x= age))
library(tidyverse)
ggplot(fulldata, aes(x= age))
ggplot(fulldata, aes(x= Age))
ggplot(fulldata, aes(x= Age))
ggplot(fulldata, aes(x=Age))
fulldata = read.csv("fangraphs.csv")
ggplot(fulldata, aes(x=Age))
ggplot(fulldata, aes(x=Age,y=ERA)) + geom_point()
ggplot(fulldata, aes(x=ERA,y=Age)) + geom_point()
ggplot(fulldata, aes(x=Age, y=ERA)) + geom_point()
ggplot(fulldata, aes(x=Age, y=IP)) + geom_point()
ggplot(fulldata, aes(x=Age, y=FB%)) + geom_point()
ggplot(fulldata, aes(x=Age, y=FB)) + geom_point()
ggplot(fulldata, aes(x=Age, y=FB\%)) + geom_point()
ggplot(fulldata, aes(x=Age, y="FB%")) + geom_point()
ggplot(fulldata, aes(x=Age, y=FB%)) + geom_point()
ggplot(fulldata, aes(x=Age, y=FB.)) + geom_point()
ggplot(fulldata, aes(x=Age, y=WAR)) + geom_point()
colnames(fulldata)
ggplot(fulldata, aes(x=Age, y=FBv)) + geom_point()
ggplot(sample(fulldata, 100), aes(x=Age, y=FBv)) + geom_point()
len(fulldata)
length(fulldata)
dim(fulldata)
sampledata <- sample_n(fulldata, 100)
sampledata
ggplot(sampledata, aes(x=Age, y=FBv)) + geom_point()
ggplot(fulldata, aes(x=Age, y=FBv)) + geom_point()
group_by(fulldata, Age)
group_by(fulldata, Age) %<% summarize()
group_by(fulldata, Age) %>% summarize()
group_by(fulldata, Age) %>% summarize(meanFBv = mean(FBv))
ggplot(fulldata, aes(x=Age, y=meanFBv)) + geom_point()
meanFBv_by_age <- group_by(fulldata, Age) %>% summarize(meanFBv = mean(FBv))
meanFBv_by_age <- group_by(fulldata, Age) %>% summarize(meanFBv = mean(FBv))
ggplot(fulldata, aes(x=Age, y=meanFBv)) + geom_point()
meanFBv_by_age
View(meanFBv_by_age)
View(meanFBv_by_age)
ggplot(meanFBv_by_age, aes(x=Age, y=meanFBv)) + geom_point()
ggplot(meanFBv_by_age, aes(x=Age, y=medianFBv)) + geom_point()
meanFBv_by_age <- group_by(fulldata, Age) %>% summarize(meanFBv = mean(FBv), medianFBv = median(FBv))
ggplot(meanFBv_by_age, aes(x=Age, y=medianFBv)) + geom_point()
ggplot(meanFBv_by_age, aes(x=Age, y=meanFBv)) + geom_point()
ggplot(meanFBv_by_age, aes(x=Age, y=medianFBv)) + geom_point()
meanFBv_by_age[meanFBv]
meanFBv_by_age$meanFBv
meanFBv_by_age$meanFBv
meanFBv_by_age$medianFBv
install.packages("here")
load("~/Google Drive/2nd Year/STAT 4996/Github Folder/.RData")
load("~/Google Drive/2nd Year/STAT 4996/Github Folder/.RData")
load("~/Google Drive/2nd Year/STAT 4996/Github Folder/.RData")
load("~/Google Drive/2nd Year/STAT 4996/Github Folder/.RData")
load("~/Google Drive/2nd Year/STAT 4996/Github Folder/.RData")
library(tidyverse)
setwd("~/Google Drive/2nd Year/STAT 4996/Github Folder/data")
fulldata <-  read.csv("fangraphs.csv")
group_by(fulldata, Year)
group_by(fulldata, Season)
data_by_season <- group_by(fulldata, Season)
data_by_season
data2018 <- filter(fulldata, Season==2018)
data2018
common_pitchers <- intersect(data2018$playerid, data2019$playerid)
data2019 <- filter(fulldata, Season==2019)
common_pitchers <- intersect(data2018$playerid, data2019$playerid)
common_pitchers
filter(data2018, playerid in common_pitchers)
data2018[playerid==common_pitchers]
data2018["playerid"==common_pitchers]
dim(common_pitchers)
length(common_pitchers)
data2018$playerid
filter(data2018, playerid %in% common_pitchers)
common2018 <- filter(data2018, playerid %in% common_pitchers)
common2019 <- filter(data2019, playerid %in% common_pitchers)
common2018
common2019
combined20182019 <- cbind(common2018, common2019$WAR, common2019$xFIP)
combined20182019
colnames(combined20182019)
?lm
lm(common2019$xFIP~Age, xFIP, FBv, FB.)
lm(common2019$xFIP~Age + xFIP + FBv +FB., data=combined20182019)
summary(basic_model)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv +FB., data=combined20182019)
summary(basic_model)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv, data=combined20182019)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv, data=combined20182019)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv, data=combined20182019)
summary(basic_model)
load("~/Google Drive/2nd Year/STAT 4996/Github Folder/.RData")
# xFIP
season_xfip <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = Season,
values_from = xFIP,
names_prefix = "xFIP_")
# install.packages('tidyverse')
library(tidyverse)
# install.packages('tidyverse')
library(tidyverse)
# install.packages('lubridate')
library(lubridate)
# install.packages('here')
library(here)
fangraphs_raw <- here::here('data', 'fangraphs.csv') %>%
read_csv()
fangraphs_raw <- here::here('data', 'fangraphs.csv') %>%
read_csv()
fangraphs_clean <- fangraphs_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup() %>%
select(1:4, 26, 5:25)
# xFIP
season_xfip <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = Season,
values_from = xFIP,
names_prefix = "xFIP_")
experience_xfip <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = experience,
values_from = xFIP,
names_prefix = "xFIP_")
season_fbv <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = Season,
values_from = FBv,
names_prefix = "FBv_")
experience_fbv <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = experience,
values_from = FBv,
names_prefix = "FBv_")
season_fbpct <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = Season,
values_from = `FB%`,
names_prefix = "FB%_")
experience_fbpct <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = experience,
values_from = `FB%`,
names_prefix = "FB%_")
# Player Data
fangraphs_player <- bind_cols(season_xfip, season_fbv, season_fbpct,
experience_xfip, experience_fbv, experience_fbpct)
# Remove intermediate data
remove(season_xfip, season_fbv, season_fbpct,
experience_xfip, experience_fbv, experience_fbpct)
View(fangraphs_player)
View(fangraphs_player)
library(tidyverse)
setwd("~/Google Drive/2nd Year/STAT 4996/Github Folder/data")
fulldata <-  read.csv("fangraphs.csv")
data2018 <- filter(fulldata, Season==2018)
data2019 <- filter(fulldata, Season==2019)
common_pitchers <- intersect(data2018$playerid, data2019$playerid)
common_pitchers
common2018 <- filter(data2018, playerid %in% common_pitchers)
common2019 <- filter(data2019, playerid %in% common_pitchers)
common2018
common2019
combined20182019 <- cbind(common2018, common2019$WAR, common2019$xFIP)
combined20182019
colnames(combined20182019)
?lm
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv, data=combined20182019)
summary(basic_model)
install.packages('tidyverse')
install.packages('lubridate')
library(lubridate)
install.packages('here')
library(here)
data_raw <- here::here('data', 'NEW Fangraphs.csv') %>%
read_csv()
library(tidyverse)
library(tidyverse)
library(tidyverse)
library(lubridate)
library(here)
data_raw <- here::here('data', 'NEW Fangraphs.csv') %>%
read_csv()
View(data_raw)
names(data_raw)
fangraphs_clean <- fangraphs_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %")),
`GB%` = as.numeric(str_remove(`GB%`, " %")),
`FB%_1` = as.numeric(str_remove(`FB%_1`, " %")),
`K%` = as.numeric(str_remove(`K%`, " %")),
`BB%` = as.numeric(str_remove(`BB%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup()
fangraphs_clean <- data_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %")),
`GB%` = as.numeric(str_remove(`GB%`, " %")),
`FB%_1` = as.numeric(str_remove(`FB%_1`, " %")),
`K%` = as.numeric(str_remove(`K%`, " %")),
`BB%` = as.numeric(str_remove(`BB%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup()
data_clean <- data_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %")),
`GB%` = as.numeric(str_remove(`GB%`, " %")),
`FB%_1` = as.numeric(str_remove(`FB%_1`, " %")),
`K%` = as.numeric(str_remove(`K%`, " %")),
`BB%` = as.numeric(str_remove(`BB%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup()
View(data_clean)
names(data_clean)
names(data_clean)[28] <- "Groundball%"
names(data_clean)[29] <- "Flyball%"
names(data_clean)
data_clean <- select(data_clean, 1, 2, 3, 4, 6, 7, 13, 5, 11, 14, 12, 15, 27, 34, 8, 9, 10, 25, 26, 28, 29, 31,
32, 16, 17, 18, 19, 20, 21, 22, 23, 24, 30, 33, 35, 36)
data_clean <- select(data_clean, 1, 2, 3, 4, 6, 7, 13, 5, 11, 14, 12, 15, 27, 34, 8, 9, 10, 25, 26, 28, 29, 31,
32, 16, 17, 18, 19, 20, 21, 22, 23, 24, 30, 35, 36)
remove(data2018)
remove(data2019)
View(data_raw)
remove(sampledata)
remove(fulldata)
remove(common2018)
remove(common2019)
remove(combined20182019)
View(basic_model)
remove(basic_model)
View(fangraphs_clean)
View(fangraphs_clean)
remove(fangraphs_raw)
remove(fangraphs_clean)
View(meanFBv_by_age)
View(meanFBv_by_age)
remove(meanFBv_by_age)
View(fangraphs_player)
remove(fangraphs_player)
remove(data)
season_data <- select(data_clean, 1, 2, 3, 4, 6, 7, 13, 5, 11, 14, 12, 15, 27, 34, 8, 9, 10, 25, 26, 28, 29, 31,
32, 16, 17, 18, 19, 20, 21, 22, 23, 24, 30, 35, 36)
data_clean <- select(data_clean, 1, 2, 3, 4, 6, 7, 13, 5, 11, 14, 12, 15, 27, 34, 8, 9, 10, 25, 26, 28, 29, 31,
32, 16, 17, 18, 19, 20, 21, 22, 23, 24, 30, 35, 36)
View(data_clean)
View(data_clean)
data_raw <- here::here('data', 'NEW Fangraphs.csv') %>%
read_csv()
data_clean <- data_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %")),
`GB%` = as.numeric(str_remove(`GB%`, " %")),
`FB%_1` = as.numeric(str_remove(`FB%_1`, " %")),
`K%` = as.numeric(str_remove(`K%`, " %")),
`BB%` = as.numeric(str_remove(`BB%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup()
data_clean <- data_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %")),
`GB%` = as.numeric(str_remove(`GB%`, " %")),
`FB%_1` = as.numeric(str_remove(`FB%_1`, " %")),
`K%` = as.numeric(str_remove(`K%`, " %")),
`BB%` = as.numeric(str_remove(`BB%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup()
names(data_clean)[28] <- "Groundball%"
names(data_clean)[29] <- "Flyball%"
names(data_clean)
data_season <- select(data_clean, 1, 2, 3, 4, 6, 7, 13, 5, 11, 14, 12, 15, 27, 34, 8, 9, 10, 25, 26, 28, 29, 31,
32, 16, 17, 18, 19, 20, 21, 22, 23, 24, 30, 35, 36)
View(data_season)
fangraphs_raw <- here::here('data', 'fangraphs.csv') %>%
read_csv()
fangraphs_raw <- here::here('data', 'fangraphs.csv') %>%
read_csv()
fangraphs_clean <- fangraphs_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup() %>%
select(1:4, 26, 5:25)
fangraphs_raw <- here::here('data', 'fangraphs.csv') %>%
read_csv()
fangraphs_raw <- here::here('data', 'fangraphs.csv') %>%
read_csv()
fangraphs_clean <- fangraphs_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup() %>%
select(1:4, 26, 5:25)
# xFIP
season_xfip <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = Season,
values_from = xFIP,
names_prefix = "xFIP_")
experience_xfip <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = experience,
values_from = xFIP,
names_prefix = "xFIP_")
season_fbv <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = Season,
values_from = FBv,
names_prefix = "FBv_")
experience_fbv <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = experience,
values_from = FBv,
names_prefix = "FBv_")
season_fbpct <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = Season,
values_from = `FB%`,
names_prefix = "FB%_")
experience_fbpct <- fangraphs_clean %>%
pivot_wider(id_cols = Name,
names_from = experience,
values_from = `FB%`,
names_prefix = "FB%_")
# Player Data
fangraphs_player <- bind_cols(season_xfip, season_fbv, season_fbpct,
experience_xfip, experience_fbv, experience_fbpct)
# Remove intermediate data
remove(season_xfip, season_fbv, season_fbpct,
experience_xfip, experience_fbv, experience_fbpct)
remove(common_pitchers)
View(fangraphs_player)
names(data_season)
data_season <- select(data_clean, 1:4,6:7,13,5,11,14,12,15,27,34,8:10,25:26,28:29,31:32,16:24,30,35:36)
names(data_season)
names(data_clean)[35] <- "Experience"
data_season <- select(data_clean, 1:4,35,6:7,13,5,11,14,12,15,27,34,8:10,25:26,28:29,31:32,16:24,30,36)
View(data_season)
View(data_season)
data_raw <- here::here('data', 'NEW Fangraphs.csv') %>%
read_csv()
data_clean <- data_raw %>%
mutate(
`FB%` = as.numeric(str_remove(`FB%`, " %")),
`SL%` = as.numeric(str_remove(`SL%`, " %")),
`CT%` = as.numeric(str_remove(`CT%`, " %")),
`CB%` = as.numeric(str_remove(`CB%`, " %")),
`CH%` = as.numeric(str_remove(`CH%`, " %")),
`SF%` = as.numeric(str_remove(`SF%`, " %")),
`KN%` = as.numeric(str_remove(`KN%`, " %")),
`GB%` = as.numeric(str_remove(`GB%`, " %")),
`FB%_1` = as.numeric(str_remove(`FB%_1`, " %")),
`K%` = as.numeric(str_remove(`K%`, " %")),
`BB%` = as.numeric(str_remove(`BB%`, " %"))
) %>%
arrange(Name, Season) %>%
group_by(Name) %>%
mutate(experience = row_number()) %>%
ungroup()
names(data_clean)
names(data_clean)[28] <- "Groundball%"
names(data_clean)[29] <- "Flyball%"
names(data_clean)[36] <- "Experience"
names(data_clean)
data_season <- select(data_clean, 1:4,36,6:7,13,5,11,14,12,15,27,34,8:10,25:26,28:29,31:32,16:24,30,35)
