jawn <- read.csv("fangraphs.csv")
jawn <- read.csv("fangraphs.csv")
View(jawn)
View(jawn)
jawn <- read.csv("fangraphs.csv")
getwd()
jawn <- read.csv("fangraphs.csv")
View(jawn)
jawn <- read.csv("fangraphs.csv")
View(jawn)
View(jawn)
View(jawn)
pitchers <- read.csv("fangraphs.csv")
View(pitchers)
library(ggplot2)
age_hist <- ggplot(pitchers, aes(age)) + geom_histogram()
age_hist
age_hist <- ggplot(pitchers, aes(Age)) + geom_histogram()
age_hist
age_hist <- ggplot(pitchers, aes(Age)) + geom_histogram(bins=100)
age_hist
age_hist <- ggplot(pitchers, aes(Age)) + geom_histogram(bins=50)
age_hist
age_hist <- ggplot(pitchers, aes(Age)) + geom_histogram(bins=20)
age_hist
age_hist <- ggplot(pitchers, aes(Age)) + geom_histogram(bins=10)
age_hist
age_hist <- ggplot(pitchers, aes(Age)) + geom_histogram(bins=15)
age_hist
age_hist <- ggplot(pitchers, aes(Age)) + geom_histogram(bins=20)
age_hist
avg_fbv <- ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat='mean')
avg_fbv <- ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="mean")
avg_fbv <- ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean")
avg_fbv
avg_fbv <- ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean") + ylim(85,100)
avg_fbv
avg_fbv <- ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean") + scale_y_continuous(
breaks = seq(85,100,1))
avg_fbv
avg_fbv <- ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean") + scale_y_continuous(limits = seq(85,100,1))
avg_fbv
avg_fbv <- ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean") + scale_y_continuous(limits = seq(85,100,1))
avg_fbv
ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean") + scale_y_continuous(limits = seq(85,100,1))
ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean") + scale_y_continuous(limits = c(80,100))
ggplot(pitchers, aes(x=Age, y=FBv)) + geom_bar(stat="summary", fun.y = "mean")
pitchers[age=20]
pitchers[age=20,]
pitchers[age==20,]
pitchers[pitchers$age==20,]
twenty <- pitchers[pitchers$age==20,]
twenty <- pitchers[pitchers$age==21,]
library(tidyverse)
install.packages("tidyverse")
library(ggplot2)
twenty <- pitchers %>%
filter(age == 21)
library(tidyverse)
twenty <- pitchers %>%
filter(age == 21)
twenty <- pitchers %>%
filter(Age == 21)
View(twenty)
twenty.length
twenty.numRows
nrow(twenty)
fb <- twenty$FBv
average(fb)
mean(fb)
avg_fbv(20)
avg_fbv <- function(age){
df <- pitchers %>%
filter(Age == age)
fb <- df$FBv
mean(fb)
}
avg_fbv(20)
avg_fbv(21)
ages <- seq(20,47,1)
ages
vel <- sapply(ages, avg_fbv)
vel
df2 <- data.frame("AGE" = ages, "Velocity" = vel)
df2
ggplot(df2, aes(x = AGE, y=Velocity)) + geom_point() + geom_line()
#Median fastball velocity by age
med_fbv <- function(age){
df <- pitchers %>%
filter(Age == age)
fb <- df$FBv
median(fb)
}
medvel <- sapply(ages, med_fbv)
medvel
df3 <- data.frame("AGE" = ages, "Median Velocity" = vel)
df3 <- data.frame("AGE" = ages, "Median_Velocity" = vel)
ggplot(df3, aes(x = AGE, y=Median_Velocity)) + geom_point() + geom_line
ggplot(df3, aes(x = AGE, y=Median_Velocity)) + geom_point() + geom_line()
medvel
vel
# Look at pitchers with great fastballs - is the dropoff steeper?
test <- pitchers %>%
filter(Season == 2002)
test$FBv
quantile(test$FBv, 0.9)
quantile(test$FBv, 0.95)
# Look at pitchers with great fastballs - is the dropoff steeper?
test <- pitchers %>%
filter(Season == 2019)
quantile(test$FBv, 0.95)
# Look at pitchers with great fastballs - is the dropoff steeper?
test <- pitchers %>%
filter(Season == 2002)
quantile(test$FBv, 0.95)
pitchers2 <- pitchers %>%
filter(FBv >= 92.82)
pitchers2 <- test %>%
filter(FBv >= 92.82)
View(pitchers2)
View(test)
git pull
pitchers <- read.csv("fangraphs.csv")
getwd()
setwd("/Users/christianrogers/Desktop/capstone/data")
pitchers <- read.csv("fangraphs.csv")
View(pitchers)
library(tidyverse)
library(ggplot2)
pitchers <- read.csv("fangraphs.csv")
setwd("/Users/christianrogers/Desktop/capstone/data")
pitchers <- read.csv("fangraphs.csv")
tw1819 <- pitchers %>%
filter(Season == 2019 | Season == 2018)
View(tw1819)
View(tw1819)
tw1819$playerid
ids <- tw1819$playerid
table(ids)
as.data.frame(table(ids))
id_df <- as.data.frame(table(ids))
print(id)
print(id)
<<<<<<< HEAD
pitchers <- read.csv("fangraphs.csv")
setwd("/Users/christianrogers/Desktop/capstone/data")
pitchers <- read.csv("fangraphs.csv")
library(tidyverse)
library(ggplot2)
# Playing around with linear models
p2018 <- filter(pitchers, season==2018)
# Playing around with linear models
p2018 <- filter(pitchers, Season==2018)
p2017 <- filter(pitchers, Season==2017)
p2019 <- filter(pitchers, Season==2019)
common <- intersect(p2018$playerid, p2019$playerid)
common18 <- filter(p2018, playerid %in% common)
common19 <- filter(p2019, playerid %in% common)
combined1819 <- cbind(common18, common19$WAR, common19$xFIP)
View(combined1819)
View(common19)
#How does WAR correlate over larger samples
p2017 <- filter(pitchers, Season==2017)
p2016 <- filter(pitchers, Season==2016)
p2015 <- filter(pitchers, Season==2015)
common2 <- intersect(p2018$playerid, p2019$playerid, p2017$playerid)
common2 <- intersect(common, p2017$playerid)
common3 <- intersect(common2, p2016$playerid)
common4 <- intersect(common3, p2015$playerid)
View(common19)
#33 pitchers have 5 consecutive season's worth of data
# Create WAR/100 IP metric to standardize
#2019
war19 <- p2019$WAR
ip19 <- p2019$IP
war19/ip19
(war19/ip19) * 100
war_per100 <- (war19/ip19) * 100
p2019 <- cbind(p2019, war_per100)
View(p2019)
p2019 <- filter(pitchers, Season==2019)
war19 <- p2019$WAR
ip19 <- p2019$IP
war_per100_19 <- (war19/ip19) * 100
p2019 <- cbind(p2019, war_per100)
View(p2019)
p2019 <- filter(pitchers, Season==2019)
war19 <- p2019$WAR
ip19 <- p2019$IP
war_per19 <- (war19/ip19) * 100
p2019 <- cbind(p2019, war_per100)
p2019 <- filter(pitchers, Season==2019)
war19 <- p2019$WAR
ip19 <- p2019$IP
war_per19 <- (war19/ip19) * 100
p2019 <- cbind(p2019, war_per19)
View(p2019)
war18 <- p2018$WAR
ip18 <- p2018$IP
war_per18 <- (war18/ip18) * 100
p2018 <- cbind(p2018, war_per18)
war17 <- p2017$WAR
ip17 <- p2017$IP
war_per17 <- (war17/ip17) * 100
p2017 <- cbind(p2017, war_per17)
war16 <- p2016$WAR
ip16 <- p2016$IP
war_per16 <- (war16/ip16) * 100
p2016 <- cbind(p2016, war_per16)
war15 <- p2015$WAR
ip15 <- p2015$IP
war_per15 <- (war15/ip15) * 100
p2015 <- cbind(p2015, war_per15)
# combine it all into one table
corr2019 <- filter(p2019, playerid %in% common4)
corr2018 <- filter(p2018, playerid %in% common4)
corr2017 <- filter(p2017, playerid %in% common4)
corr2016 <- filter(p2016, playerid %in% common4)
corr2015 <- filter(p2015, playerid %in% common4)
View(corr2015)
combined_corr <- cbind(corr2019, corr2018$war_per18, corr2018$xFIP, corr2017$war_per17, corr2017$xFIP,
corr2016$war_per16, corr2016$xFIP, corr2015$war_per15, corr2015$xFIP)
View(combined_corr)
#How do WAR and xFip correlate over the years?
corr(combined_corr$`corr2018$war_per18`, combined_corr$war_per19)
#How do WAR and xFip correlate over the years?
cor(combined_corr$`corr2018$war_per18`, combined_corr$war_per19)
cor(war_per18, war_per19)
#How do WAR and xFip correlate over the years?
cor(combined_corr$`corr2018$war_per18`, combined_corr$war_per19)
#2018-2019 xFip =
cor(combined_corr$`corr2018$xFIP`, combined_corr$xFIP)
#2017-2019 WAR = 0.65
cor(combined_corr$`corr2017$war_per17`, combined_corr$war_per19)
#2018-2019 xFip = 0.81
cor(combined_corr$`corr2017$xFIP`, combined_corr$xFIP)
#2016-2019 WAR = 0.65
cor(combined_corr$`corr2016$war_per16`, combined_corr$war_per19)
#2016-2019 xFip = 0.81
cor(combined_corr$`corr2016$xFIP`, combined_corr$xFIP)
#2015-2019 WAR = 0.65
cor(combined_corr$`corr2015$war_per15`, combined_corr$war_per19)
#2015-2019 xFip = 0.81
cor(combined_corr$`corr2015$xFIP`, combined_corr$xFIP)
corr2019_2 <- filter(p2019, playerid %in% common2)
corr2018_2 <- filter(p2018, playerid %in% common2)
corr2017_2 <- filter(p2017, playerid %in% common2)
combined_corr_2 <- cbind(corr2019_2, corr2018_2$war_per18, corr2018_2$xFIP, corr2017_2$war_per17, corr2017_2$xFIP)
#2018-2019 WAR pt2 = 0.65
cor(combined_corr_2$`corr2018_2$war_per18`, combined_corr_2$war_per19)
#2018-2019 xFip pt2 = 0.81
cor(combined_corr_2$`corr2018$xFIP`, combined_corr_2$xFIP)
#2018-2019 xFip pt2 = 0.81
cor(combined_corr_2$`corr2018_2$xFIP`, combined_corr_2$xFIP)
#2018-2019 WAR pt2 = 0.53
cor(combined_corr_2$`corr2018_2$war_per18`, combined_corr_2$war_per19)
#2018-2019 WAR pt2 = 0.53
cor(combined_corr_2$`corr2017_2$war_per18`, combined_corr_2$war_per19)
#2018-2019 WAR pt2 = 0.53
cor(combined_corr_2$`corr2017_2$war_per17`, combined_corr_2$war_per19)
#2018-2019 xFip pt2 = 0.76
cor(combined_corr_2$`corr2017_2$xFIP`, combined_corr_2$xFIP)
=======
=======
setwd("~/Google Drive/2nd Year/STAT 4996/Github Folder/data")
fulldata <-  read.csv("fangraphs.csv")
group_by(fulldata, Year)
group_by(fulldata, Season)
data_by_season <- group_by(fulldata, Season)
data_by_season
data2018 <- filter(fulldata, Season==2018)
data2018
common_pitchers <- intersect(data2018$playerid, data2019$playerid)
data2019 <- filter(fulldata, Season==2019)
common_pitchers <- intersect(data2018$playerid, data2019$playerid)
common_pitchers
filter(data2018, playerid in common_pitchers)
data2018[playerid==common_pitchers]
data2018["playerid"==common_pitchers]
dim(common_pitchers)
length(common_pitchers)
data2018$playerid
filter(data2018, playerid %in% common_pitchers)
common2018 <- filter(data2018, playerid %in% common_pitchers)
common2019 <- filter(data2019, playerid %in% common_pitchers)
common2018
common2019
combined20182019 <- cbind(common2018, common2019$WAR, common2019$xFIP)
combined20182019
colnames(combined20182019)
?lm
lm(common2019$xFIP~Age, xFIP, FBv, FB.)
lm(common2019$xFIP~Age + xFIP + FBv +FB., data=combined20182019)
summary(basic_model)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv +FB., data=combined20182019)
summary(basic_model)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv, data=combined20182019)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv, data=combined20182019)
basic_model <- lm(common2019$xFIP~Age + xFIP + FBv, data=combined20182019)
summary(basic_model)
<<<<<<< HEAD
load("~/Google Drive/2nd Year/STAT 4996/Github Folder/.RData")
=======
>>>>>>> 1bfa21373924a199c3a5a8fc578b09de84d76a3e
>>>>>>> 667613aa2d9c821ca9af5ab4e219f4233a3d6601
>>>>>>> 5137b0241e1a0ebe075b2d6e8f103031ae4e341c
